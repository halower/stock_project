# å¿«é€Ÿå‚è€ƒå¡ç‰‡

## ğŸš€ å¯åŠ¨æœåŠ¡

```bash
cd stock_app_service
docker-compose down
docker-compose up -d
```

## ğŸ“Š å®æ—¶æ•°æ®é…ç½®

### ç¯å¢ƒå˜é‡ï¼ˆdocker-compose.ymlï¼‰
```yaml
- REALTIME_UPDATE_ENABLED=true       # å¯ç”¨å®æ—¶æ›´æ–°
- REALTIME_DATA_PROVIDER=tushare     # ä½¿ç”¨Tushare
- REALTIME_UPDATE_INTERVAL=20        # 20åˆ†é’Ÿæ›´æ–°ä¸€æ¬¡
- TUSHARE_TOKEN=ä½ çš„token            # å¿…é¡»é…ç½®
```

### æµ‹è¯•å‘½ä»¤
```bash
python test_realtime_tushare.py
```

## ğŸ”„ å…¨é‡æ›´æ–°é…ç½®

### æ¨èé…ç½®
```python
result = await stock_atomic_service.full_update_all_stocks(
    days=180,
    batch_size=50,
    max_concurrent=5  # æ¨èå€¼
)
```

### é…ç½®è°ƒæ•´æŒ‡å—
| åœºæ™¯ | å¹¶å‘æ•° | æ‰¹æ¬¡å¤§å° | è¯´æ˜ |
|------|--------|---------|------|
| å¿«é€Ÿæ›´æ–° | 5 | 50 | å¹³è¡¡é€Ÿåº¦å’ŒæˆåŠŸç‡ï¼ˆæ¨èï¼‰ |
| é«˜æˆåŠŸç‡ | 3 | 30 | æœ€é«˜æˆåŠŸç‡ï¼Œé€Ÿåº¦è¾ƒæ…¢ |
| æµ‹è¯•ç¯å¢ƒ | 2 | 20 | æœ€ä¿å®ˆé…ç½® |

### æµ‹è¯•å‘½ä»¤
```bash
python test_full_update_optimization.py
```

## ğŸ“ˆ ç›‘æ§å‘½ä»¤

### æŸ¥çœ‹æ—¥å¿—
```bash
# å®æ—¶æ—¥å¿—
docker-compose logs -f api

# æœ€è¿‘100è¡Œ
docker-compose logs --tail=100 api

# æœç´¢é”™è¯¯
docker-compose logs api | grep ERROR
```

### æŸ¥çœ‹ç»Ÿè®¡
```python
from app.services.realtime import get_realtime_service

service = get_realtime_service()
stats = service.get_stats()
print(stats)
```

## âš ï¸ å¸¸è§é—®é¢˜

### 1. Tokenæœªé…ç½®
```
é”™è¯¯: Tushare Tokenæœªé…ç½®
è§£å†³: åœ¨docker-compose.ymlä¸­é…ç½®TUSHARE_TOKEN
```

### 2. æƒé™ä¸è¶³
```
é”™è¯¯: æƒé™ä¸è¶³
è§£å†³: è®¿é—® https://tushare.pro ç”³è¯·æƒé™
```

### 3. å¤±è´¥ç‡é«˜
```
åŸå› : å¹¶å‘æ•°è¿‡é«˜
è§£å†³: é™ä½max_concurrentè‡³3
```

### 4. æ•°æ®ä¸ºç©º
```
åŸå› : éäº¤æ˜“æ—¶é—´
è§£å†³: åœ¨äº¤æ˜“æ—¶é—´æµ‹è¯•ï¼ˆ9:30-15:00ï¼‰
```

## ğŸ“ å…³é”®æŒ‡æ ‡

### å®æ—¶æ•°æ®
- âœ… æˆåŠŸç‡: â‰¥99%
- âœ… å“åº”æ—¶é—´: <2ç§’
- âœ… æ›´æ–°é¢‘ç‡: 20åˆ†é’Ÿ

### å…¨é‡æ›´æ–°
- âœ… åˆå§‹æˆåŠŸç‡: â‰¥95%
- âœ… æœ€ç»ˆæˆåŠŸç‡: â‰¥99.5%
- âœ… æ€»è€—æ—¶: 12-15åˆ†é’Ÿ
- âœ… å¤±è´¥è‚¡ç¥¨: <25åª

## ğŸ”§ å¿«é€Ÿä¿®å¤

### é‡å¯æœåŠ¡
```bash
docker-compose restart api
```

### æ¸…ç†ç¼“å­˜
```bash
docker-compose exec api redis-cli FLUSHALL
```

### æŸ¥çœ‹é…ç½®
```bash
docker-compose exec api env | grep REALTIME
```

## ğŸ“š æ–‡æ¡£é“¾æ¥

- [å®Œæ•´ä¼˜åŒ–æ€»ç»“](ä¼˜åŒ–æ€»ç»“_å…¨é‡æ›´æ–°å’Œå®æ—¶æ¥å£.md)
- [å®æ—¶æ›´æ–°è¯´æ˜](REALTIME_UPDATE_README.md)
- [å…¨é‡æ›´æ–°ä¼˜åŒ–](å…¨é‡æ›´æ–°ä¼˜åŒ–è¯´æ˜.md)

